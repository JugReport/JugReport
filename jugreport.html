<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <title>JUG REPORT</title>
    <style>
        body {
            font-family: 'Times New Roman', Times, serif;
            background-color: white;
            margin: 0;
            padding: 20px;
            color: black;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 18px;
            color: #666;
        }
        
        .main-headline {
            text-align: center;
            margin-bottom: 10px;
        }
        
        .main-headline a {
            color: #CC0000;
            text-decoration: none;
            font-size: 28px;
            font-weight: bold;
            line-height: 1.3;
        }
        
        .main-headline a:hover {
            text-decoration: underline;
        }
        
        .main-headline .image-container {
            max-width: 600px;
            width: 100%;
            margin: 10px auto;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .main-headline img {
            max-width: 100%;
            height: auto;
            display: block;
        }
        
        .site-title {
            text-align: center;
            font-size: 48px;
            font-weight: bold;
            color: black;
            margin: 30px 0;
            letter-spacing: 2px;
        }
        
        .columns {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 30px;
        }
        
        .column {
            padding: 0 10px;
        }
        
        .headline {
            margin-bottom: 25px;
        }
        
        .headline a {
            color: black;
            text-decoration: none;
            font-size: 14px;
            font-weight: bold;
            line-height: 1.4;
        }
        
        .headline a:hover {
            color: #CC0000;
            text-decoration: underline;
        }
        
        .headline .image-container {
            width: 100%;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            margin-top: 8px;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .headline img {
            width: 100%;
            height: auto;
            display: block;
        }
        
        hr {
            border: none;
            border-top: 1px solid #ccc;
            margin: 30px 0;
        }
        
        @media (max-width: 768px) {
            .columns {
                grid-template-columns: 1fr;
            }
            
            .site-title {
                font-size: 32px;
            }
            
            .main-headline a {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="loading" id="loading">Loading JUG REPORT...</div>
        <div id="content" style="display: none;">
            <!-- Main Headline -->
            <div class="main-headline" id="mainHeadline"></div>
            
            <!-- Site Title -->
            <div class="site-title">JUG REPORT</div>
            
            <hr>
            
            <!-- Three Columns of Headlines -->
            <div class="columns">
                <div class="column" id="column1"></div>
                <div class="column" id="column2"></div>
                <div class="column" id="column3"></div>
            </div>
        </div>
    </div>

    <script>
        // Fetch and parse the text file
        async function loadContent() {
            try {
                const response = await fetch('https://jugreport.github.io/JugReport/jug.txt', {
                    method: 'GET',
                    headers: {
                        'Accept': 'text/plain'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const text = await response.text();
                
                // Parse the text file
                const lines = text.trim().split('\n').filter(line => line.trim());
                const articles = [];
                let mainHeadline = null;
                
                lines.forEach(line => {
                    const parts = line.split('|').map(p => p.trim());
                    if (parts.length >= 3) {
                        const article = {
                            url: parts[0],
                            headline: parts[1],
                            image: parts[2],
                            isMain: parts[3] === 'HEADLINE'
                        };
                        
                        if (article.isMain) {
                            mainHeadline = article;
                        } else {
                            articles.push(article);
                        }
                    }
                });
                
                // Render main headline
                if (mainHeadline) {
                    document.getElementById('mainHeadline').innerHTML = `
                        <a href="${escapeHtml(mainHeadline.url)}" target="_blank" rel="noopener noreferrer">
                            ${escapeHtml(mainHeadline.headline)}
                        </a>
                        <br>
                        <div class="image-container">
                            <img crossorigin="anonymous" referrerpolicy="no-referrer" 
                                 src="${escapeHtml(mainHeadline.image)}" 
                                 alt="${escapeHtml(mainHeadline.headline)}" 
                                 onerror="this.parentElement.innerHTML='<div style=\\'padding:20px;text-align:center;color:#666;\\'>Image preview unavailable - click headline to view</div>'">
                        </div>
                    `;
                }
                
                // Distribute articles across three columns
                const columns = [[], [], []];
                articles.forEach((article, index) => {
                    columns[index % 3].push(article);
                });
                
                // Render columns
                columns.forEach((columnArticles, colIndex) => {
                    const columnElement = document.getElementById(`column${colIndex + 1}`);
                    columnElement.innerHTML = columnArticles.map(article => `
                        <div class="headline">
                            <a href="${escapeHtml(article.url)}" target="_blank" rel="noopener noreferrer">
                                ${escapeHtml(article.headline)}
                            </a>
                            <br>
                            <div class="image-container">
                                <img crossorigin="anonymous" referrerpolicy="no-referrer" 
                                     src="${escapeHtml(article.image)}" 
                                     alt="${escapeHtml(article.headline)}" 
                                     onerror="this.parentElement.innerHTML='<div style=\\'padding:15px;text-align:center;color:#666;font-size:12px;\\'>Image unavailable</div>'">
                            </div>
                        </div>
                    `).join('');
                });
                
                // Hide loading, show content
                document.getElementById('loading').style.display = 'none';
                document.getElementById('content').style.display = 'block';
                
            } catch (error) {
                console.error('Error loading content:', error);
                document.getElementById('loading').innerHTML = `
                    <div style="color: #CC0000;">
                        <p><strong>Error loading content:</strong> ${escapeHtml(error.message)}</p>
                        <p style="font-size: 14px; margin-top: 10px; color: #666;">
                            Please check the browser console for more details.
                        </p>
                    </div>
                `;
            }
        }
        
        // Escape HTML to prevent XSS
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // Load content when page loads
        window.addEventListener('DOMContentLoaded', loadContent);
    </script>
</body>
</html>